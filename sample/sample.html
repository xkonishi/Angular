<div class="card">
  <div class="card-header">条件部</div>
  <div class="card-body">
    <form [formGroup]="ankenSearchForm" (ngSubmit)="searchAnkens()" class="container-fluid">
      <div class="form-row">
        <div class="form-group form-inline col-md-3">
          <label class="mr-2">案件ID</label>
          <input [formControl]="ankenSearchForm.get('ankenId')" class="form-control col-md-6">
        </div>
        <div class="form-group form-inline col-md-6">
          <label class="mr-2">案件名</label>
          <input [formControl]="ankenSearchForm.get('ankenMei')" type="text" class="form-control col-md-10">
        </div>
        <div class="form-group form-inline col-md-3">
          <label class="mr-2">進捗状況</label>
          <select [formControl]="ankenSearchForm.get('shinchokuKbn')" class="form-control">
            <option value="10">10 内示･先行着手</option>
            <option value="20">20 受注確定</option>
            <option value="30">30 仕掛</option>
            <option value="40">40 売上</option>
          </select>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group form-inline col-md-6">
          <label class="mr-2">営業担当</label>
          <div class="input-group">
            <input [formControl]="ankenSearchForm.get('eigyouTantoCd')" type="text" class="form-control col-md-3">
            <button type="submit"  class="btn btn-secondary">参照</button>
            <input type="text" class="form-control">
          </div>
        </div>
        <div class="form-group form-inline col-md-6">
          <label class="mr-2">受注日</label>
          <div class="input-group">
            <p-calendar [formControl]="ankenSearchForm.get('juchuBiFrom')" [showIcon]="true" [locale]="locale" dateFormat="yy/mm/dd" placeholder="yyyy/mm/dd" showButtonBar="true"></p-calendar>
            <span style="margin-left:25px">～</span>
            <p-calendar [formControl]="ankenSearchForm.get('juchuBiTo')" [showIcon]="true" [locale]="locale" dateFormat="yy/mm/dd" placeholder="yyyy/mm/dd" showButtonBar="true"></p-calendar>
          </div>
        </div>
      </div>
      <button class="btn btn-primary" [disabled]="ankenList.length > 0">検索</button>
    </form>
  </div>
</div>
<div class="card mt-2">
  <div class="card-header">明細部</div>
  <div class="card-body">
    <form [formGroup]="ankensForm" (ngSubmit)="commit()">
      <div style="overflow-x:scroll">
        <table class="table table-bordered table-striped table-hover">
          <thead class="thead-light">
            <tr>
              <th width="40px"></th>
              <th width="40px">選択</th>
              <th width="75px">案件ID</th>
              <th width="180px">案件区分</th>
              <th width="180px">営業区分</th>
              <th width="180px">進捗状況</th>
              <th width="200px"><span class="label-required">*</span> 案件名</th>
              <th width="320px">営業担当</th>
              <th width="185px">受注日</th>
              <th width="120px">受注金額</th>
            </tr>
          </thead>
          <tbody>
            <ng-template ngFor let-anken [ngForOf]="sortCurrentPageRows" let-i="index">
              <tr>
                <th>{{anken.rowNo}}</th>
                <td>
                  <input [formControl]="anken.get('checked')" type="checkbox"/>
                </td>
                <td>{{anken.get('ankenId').value}}</td>
                <td>
                  <select [formControl]="anken.get('ankenKbn')" class="form-control">
                    <option value="10">10 開発(SI)</option>
                    <option value="20">20 開発(パッケージ)</option>
                    <option value="30">30 運用･保守</option>
                    <option value="40">40 交通費･旅費</option>
                    <option value="50">50 技術支援</option>
                    <option value="60">60 サーバ･ハード</option>
                    <option value="70">70 営業支援</option>
                  </select>
                </td>
                <td>
                  <select [formControl]="anken.get('eigyoKbn')" class="form-control">
                    <option value="10">10 製造業</option>
                    <option value="20">20 卸売・小売業</option>
                    <option value="30">30 金融･保険業</option>
                    <option value="40">40 医療･福祉</option>
                    <option value="50">50 サービス業</option>
                    <option value="90">90 その他</option>
                  </select>
                </td>
                <td>
                  <select [formControl]="anken.get('shinchokuKbn')" class="form-control">
                    <option value="10">10 内示･先行着手</option>
                    <option value="20">20 受注確定</option>
                    <option value="30">30 仕掛</option>
                    <option value="40">40 売上</option>
                  </select>
                </td>
                <td>
                  <input appFormcontrolBehavior="案件名" [formControl]="anken.get('ankenMei')" type="text" class="form-control">
                </td>
                <td>
                  <div class="input-group">
                    <input [formControl]="anken.get('eigyoTantoCd')" type="text" class="form-control">
                    <button type="button"  class="btn btn-secondary">参照</button>
                    <input [formControl]="anken.get('eigyoTantoMei')" type="text" class="form-control">
                  </div>
                </td>
                <td>
                  <div class="input-group">
                    <p-calendar [formControl]="anken.get('juchuBiDate')" [showIcon]="true" [locale]="locale" dateFormat="yy/mm/dd" placeholder="yyyy/mm/dd" showButtonBar="true"></p-calendar>
                  </div>
                </td>
                <td>
                  <input appFormcontrolBehavior="受注金額" [formControl]="anken.get('juchuKingaku')" type="number" class="form-control">
                </td>
              </tr>
            </ng-template>
          </tbody>
        </table>
      </div>
      <div>
        <app-ex-paginator [totalRecords]="ankenList.length" [rows]="10" [alwaysShow]="false" [showConfirmDialog]="ankensForm.dirty || isSelected" (pageChange)="onPageChange($event)"></app-ex-paginator>
      </div>
      <hr>
      <button type="button" class="btn btn-primary mr-2" (click)="clearAnkens()">クリア</button>
      <button type="button" class="btn btn-primary mr-2" (click)="removeAnkens()" [disabled]="!isSelected">削除</button>
      <button class="btn btn-primary" [disabled]="isSelected || !isUpdated">確定</button>
    </form>
  </div>
</div>
